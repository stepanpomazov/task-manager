<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Мониторинг сотрудников</title>
    <link rel="stylesheet" href="src/styles/globals.css" />
    <link rel="stylesheet" href="src/styles/date-selector-styles.css" />
    <link rel="stylesheet" href="src/styles/table-styles.css" />
  </head>
  <body>
    <div class="container">
      <div id="date-selector" class="date-selector"></div>
      <div id="department-selector" class="department-selector"></div>
      <hr />
      <div id="monitoring-table" class="monitoring-container"></div>

      <script src="src/components/DateSelector/DateSelector.js"></script>
    </div>
    <div class="table-wrapper"> <!--Привет-->
      <table>
        <thead>
          <tr>
            <th>Имя</th>
            <th>1</th>
            <th>2</th>
            <th>3</th>
            <th>4</th>
            <th>5</th>
            <th>6</th>
            <th>7</th>
            <th>8</th>
            <th>9</th>
            <th>10</th>
            <th>11</th>
            <th>12</th>
            <th>13</th>
            <th>14</th>
            <th>15</th>
            <th>Итог</th>
          </tr>
        </thead>
        <tbody>
          <!-- Главный отдел Back -->
          <tr class="main-department top-level" data-toggle="back-department">
            <td colspan="17">
              <div class="cell-content">
                <svg
                  class="toggle-icon"
                  width="16"
                  height="16"
                  viewBox="0 0 16 16"
                  fill="none"
                >
                  <path
                    d="M6 12L10 8L6 4"
                    stroke="black"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                BACK
              </div>
            </td>
          </tr>

          <tr class="employee" data-parent="back-department">
            <td>
              <div class="name-indent">Иванов Иван</div>
            </td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>Итог</td>
          </tr>

          <tr class="employee" data-parent="back-department">
            <td>
              <div class="name-indent">Иванов Иван</div>
            </td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>Итог</td>
          </tr>

          <tr class="employee" data-parent="back-department">
            <td>
              <div class="name-indent">Иванов Иван</div>
            </td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>Итог</td>
          </tr>

          <!-- Подразделение Коммерческий -->
          <tr
            class="sub-department"
            data-toggle="commercial-department"
            data-parent="back-department"
          >
            <td colspan="17">
              <div class="cell-content">
                <svg
                  class="toggle-icon"
                  width="16"
                  height="16"
                  viewBox="0 0 16 16"
                  fill="none"
                >
                  <path
                    d="M6 12L10 8L6 4"
                    stroke="black"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                Коммерческий отдел
              </div>
            </td>
          </tr>

          <!-- Подразделение Back -->
          <tr
            class="sub-department"
            data-toggle="back-sub-department"
            data-parent="back-department"
          >
            <td colspan="17">
              <div class="cell-content">
                <svg
                  class="toggle-icon"
                  width="16"
                  height="16"
                  viewBox="0 0 16 16"
                  fill="none"
                >
                  <path
                    d="M6 12L10 8L6 4"
                    stroke="black"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                Отдел Back
              </div>
            </td>
          </tr>

          <!-- Сотрудники подразделения Back -->
          <tr class="employee-nested" data-parent="back-sub-department">
            <td>
              <div class="name-indent">Иванов Иван</div>
            </td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>Итог</td>
          </tr>

          <tr class="employee-nested" data-parent="back-sub-department">
            <td>
              <div class="name-indent">Иванов Иван</div>
            </td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>Итог</td>
          </tr>

          <!-- Подразделение IT -->
          <tr
            class="sub-department"
            data-toggle="it-department"
            data-parent="back-department"
          >
            <td colspan="17">
              <div class="cell-content">
                <svg
                  class="toggle-icon"
                  width="16"
                  height="16"
                  viewBox="0 0 16 16"
                  fill="none"
                >
                  <path
                    d="M6 12L10 8L6 4"
                    stroke="black"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                IT Отдел
              </div>
            </td>
          </tr>

          <!-- Главный отдел Front -->
          <tr class="main-department top-level" data-toggle="front-department">
            <td colspan="17">
              <div class="cell-content">
                <svg
                  class="toggle-icon"
                  width="16"
                  height="16"
                  viewBox="0 0 16 16"
                  fill="none"
                >
                  <path
                    d="M6 12L10 8L6 4"
                    stroke="black"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                FRONT
              </div>
            </td>
          </tr>

          <!-- Сотрудники Front -->
          <tr class="employee" data-parent="front-department">
            <td>
              <div class="name-indent">Иванов Иван</div>
            </td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>Итог</td>
          </tr>

          <tr class="employee" data-parent="front-department">
            <td>
              <div class="name-indent">Иванов Иван</div>
            </td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>2</td>
            <td>Итог</td>
          </tr>
        </tbody>
      </table>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Инициализация - скрываем все вложенные элементы
      document.querySelectorAll('[data-parent]').forEach(row => {
        row.classList.add('hidden');
      });

      // Обработчик клика по отделам
      document.querySelectorAll('.main-department, .sub-department').forEach(row => {
        row.addEventListener('click', function() {
          const toggleId = this.getAttribute('data-toggle');
          if (!toggleId) return;

          // Находим иконку и переворачиваем ее
          const icon = this.querySelector('.toggle-icon');
          icon.classList.toggle('rotated');

          // Находим все дочерние элементы
          const childRows = document.querySelectorAll(`tr[data-parent="${toggleId}"]`);
          childRows.forEach(childRow => {
            childRow.classList.toggle('hidden');
            
            // Если скрываем подраздел, скрываем и его детей
            if (childRow.classList.contains('sub-department')) {
              const childToggleId = childRow.getAttribute('data-toggle');
              if (childToggleId && childRow.classList.contains('hidden')) {
                const nestedRows = document.querySelectorAll(`tr[data-parent="${childToggleId}"]`);
                nestedRows.forEach(nestedRow => {
                  nestedRow.classList.add('hidden');
                  // Возвращаем иконку в исходное состояние
                  const nestedIcon = childRow.querySelector('.toggle-icon');
                  if (nestedIcon) nestedIcon.classList.remove('rotated');
                });
              }
            }
          });
        });
      });
    });
  </script>
  </body>
</html>
